<!DOCTYPE html>
<html lang="ja">
<head>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Hiragino Kaku Gothic ProN", "Yu Gothic UI", sans-serif;
            background-color: #f4f4f8; margin: 0; padding: 0; color: #1C1C1E;
        }
        .header {
            background-color: #FFFFFF; padding: 16px 24px; border-bottom: 1px solid #E0E0E0;
            font-size: 1.2em; font-weight: 600;
        }
        .container { max-width: 1000px; margin: 24px auto; padding: 0 24px; }
        .toolbar { display: flex; justify-content: space-between; align-items: center; margin-bottom: 24px; }
        .search-bar { flex-grow: 1; margin-right: 16px; }
        .search-bar input { width: 100%; padding: 10px 14px; font-size: 1em; border-radius: 8px; border: 1px solid #C6C6C8; }
        .btn { padding: 10px 16px; font-size: 1em; border-radius: 8px; border: none; cursor: pointer; text-decoration: none; color: #FFFFFF; }
        .btn-primary { background-color: #34C759; }
        .list-card { background-color: #FFFFFF; border-radius: 12px; box-shadow: 0 2px 8px rgba(0,0,0,0.05); overflow: hidden; }
        .list-card h2 { font-size: 1.1em; padding: 16px 20px; margin: 0; border-bottom: 1px solid #E0E0E0; }
        .table-wrapper { overflow-x: auto; }
        table { width: 100%; border-collapse: collapse; }
        th, td { padding: 16px 20px; text-align: left; border-bottom: 1px solid #F2F2F2; }
        th { font-size: 0.9em; color: #6D6D72; }
        td a { color: #007AFF; text-decoration: none; margin-right: 12px; }
    </style>
</head>
<body>

    <div class="header">
        è­°äº‹éŒ²ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ  (æ–°ã®ã–ã‚ã“ã©ã‚‚åœ’å»ºè¨­å·¥äº‹)
    </div>

    <div class="container">
        <div class="toolbar">
            <div class="search-bar">
                <input type="text" id="search-input" placeholder="ğŸ” &quot;ã‚¹ãƒªãƒ¼ãƒ–å›³&quot; ãªã©ã§ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå†…ã‚’æ¤œç´¢...">
            </div>
            <a href="?page=edit" class="btn btn-primary">â• æ–°è¦è­°äº‹éŒ²ã‚’ä½œæˆ</a>
        </div>

        <div class="list-card">
            <h2>â–¼ è­°äº‹éŒ²ä¸€è¦§</h2>
            <div class="table-wrapper">
                <table>
                    <thead>
                        <tr>
                            <th>æ‰“åˆã›å</th>
                            <th>æ‰“åˆã›æ—¥</th>
                            <th>æœ€çµ‚ç·¨é›†è€…</th>
                            <th>ã‚¢ã‚¯ã‚·ãƒ§ãƒ³</th>
                        </tr>
                    </thead>
                    <tbody id="minutes-list-body">
                        <tr><td colspan="4">èª­ã¿è¾¼ã¿ä¸­...</td></tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <script>
        /**
         * ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿æ™‚ã«å®Ÿè¡Œ
         */
        document.addEventListener("DOMContentLoaded", function() {
            // è­°äº‹éŒ²ä¸€è¦§ã‚’ã‚µãƒ¼ãƒãƒ¼(Code.gs)ã‹ã‚‰å–å¾—
            google.script.run.withSuccessHandler(displayMinutesList)
                             .loadMinutesList();
        });

        /**
         * è­°äº‹éŒ²ä¸€è¦§ã‚’ãƒ†ãƒ¼ãƒ–ãƒ«ã«æç”»ã™ã‚‹
         * @param {Array} list - Code.gsã‹ã‚‰è¿”ã•ã‚ŒãŸè­°äº‹éŒ²ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®é…åˆ—
         */
        function displayMinutesList(list) {
            const tbody = document.getElementById("minutes-list-body");
            tbody.innerHTML = ""; // èª­ã¿è¾¼ã¿ä¸­... ã‚’ã‚¯ãƒªã‚¢

            if (!list || list.length === 0) {
                tbody.innerHTML = '<tr><td colspan="4">è­°äº‹éŒ²ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚</td></tr>';
                return;
            }

            list.forEach(item => {
                const row = tbody.insertRow();
                row.innerHTML = `
                    <td>${escapeHTML(item.name)}</td>
                    <td>${escapeHTML(item.date)}</td>
                    <td>${escapeHTML(item.editor)}</td>
                    <td>
                        <a href="?page=edit&id=${escapeHTML(item.id)}">ç·¨é›†</a>
                        <a href="#">PDF</a>
                        <a href="#">Excel</a>
                    </td>
                `;
            });
        }

        /**
         * HTMLã‚¨ã‚¹ã‚±ãƒ¼ãƒ—ç”¨ãƒ˜ãƒ«ãƒ‘ãƒ¼
         */
        function escapeHTML(str) {
            return str.replace(/[&<>"']/g, function(match) {
                return {
                    '&': '&amp;', '<': '&lt;', '>': '&gt;', '"': '&quot;', "'": '&#39;'
                }[match];
            });
        }
    </script>
</body>
</html>
